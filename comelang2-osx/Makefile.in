#########################################
# installed directories
#########################################
prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
datadir=@datadir@
mandir=@mandir@
sharedstatedir=@sharedstatedir@
sysconfdir=@sysconfdir@/comelang
includedir=@includedir@/comelang
datarootdir=@datarootdir@/comelang
docdir=@datadir@/doc
libdir=@libdir@

#########################################
# environmnet variables
#########################################
CC=@CC@
CXX=@CXX@
INSTALL=@INSTALL@
CFLAGS=@CFLAGS@
CFLAGS2=`echo $(CFLAGS) | sed -e 's/-O2//'`
CXXFLAGS=@CXXFLAGS@
CXXFLAGS2=@CXXFLAGS2@
LIBS=@LIBS@
OS=@OS@
DESTDIR=@DESTDIR@
OBJS=@OBJS@
CLANG=@CLANG@
SELF_HOST_OBJS=@SELF_HOST_OBJS@

#########################################
# main
#########################################
all: comelang2-sh

comelang2-val: remove-val-obj 01main.c.val.o 02transpile.c.val.o 03transpile2.c.val.o 04heap.c.val.o 05function.c.val.o 05function2.c.val.o 05function3.c.val.o 05function4.c.val.o 06str.c.val.o 07var.c.val.o 08if.c.val.o 09while.c.val.o 10do_while.c.val.o 11for.c.val.o 12switch.c.val.o 13op.c.val.o 14struct.c.val.o 15union.c.val.o 16enum.c.val.o 17typedef.c.val.o 18field.c.val.o 19eq.c.val.o 20method.c.val.o 21obj.c.val.o 22impl.c.val.o 23interface.c.val.o install-lib
	sudo mkdir -p "$(DESTDIR)/lib"
	sudo $(INSTALL) -m 644 ./libcomelang2.a "$(DESTDIR)/lib"
	./comelang2 -o comelang2-val  01main.c.val.o 02transpile.c.val.o 03transpile2.c.val.o 04heap.c.val.o 05function.c.val.o 05function2.c.val.o 05function3.c.val.o 05function4.c.val.o 06str.c.val.o 07var.c.val.o 08if.c.val.o 09while.c.val.o 10do_while.c.val.o 11for.c.val.o 12switch.c.val.o 13op.c.val.o 14struct.c.val.o 15union.c.val.o 16enum.c.val.o 17typedef.c.val.o 18field.c.val.o 19eq.c.val.o 20method.c.val.o 21obj.c.val.o 22impl.c.val.o 23interface.c.val.o

remove-val-obj:
	rm -f *.val.o

01main.c.val.o: 01main.c
	valgrind ./comelang2-val -o 01main.c.val.o -c 01main.c 2> 01main.c.val

02transpile.c.val.o: 02transpile.c
	valgrind ./comelang2-val -o 02transpile.c.val.o -c 02transpile.c 2> 02transpile.c.val

03transpile2.c.val.o: 03transpile2.c
	valgrind ./comelang2-val -o 03transpile2.c.val.o -c 03transpile2.c 2> 03transpile2.c.val

04heap.c.val.o: 04heap.c
	valgrind ./comelang2-val -o 04heap.c.val.o -c 04heap.c 2> 04heap.c.val

05function.c.val.o: 05function.c
	valgrind ./comelang2-val -o 05function.c.val.o -c 05function.c 2> 05function.c.val

05function2.c.val.o: 05function2.c
	valgrind ./comelang2-val -o 05function2.c.val.o -c 05function2.c 2> 05function2.c.val

05function3.c.val.o: 05function3.c
	valgrind ./comelang2-val -o 05function3.c.val.o -c 05function3.c 2> 05function3.c.val

05function4.c.val.o: 05function4.c
	valgrind ./comelang2-val -o 05function4.c.val.o -c 05function4.c 2> 05function4.c.val

06str.c.val.o: 06str.c
	valgrind ./comelang2-val -o 06str.c.val.o -c 06str.c 2> 06str.c.val

07var.c.val.o: 07var.c
	valgrind ./comelang2-val -o 07var.c.val.o -c 07var.c 2> 07var.c.val

08if.c.val.o: 08if.c
	valgrind ./comelang2-val -o 08if.c.val.o -c 08if.c 2> 08if.c.val

09while.c.val.o: 09while.c
	valgrind ./comelang2-val -o 09while.c.val.o -c 09while.c 2> 09while.c.val

10do_while.c.val.o: 10do_while.c
	valgrind ./comelang2-val -o 10do_while.c.val.o -c 10do_while.c 2> 10do_while.c.val

11for.c.val.o: 11for.c
	valgrind ./comelang2-val -o 11for.c.val.o -c 11for.c 2> 11for.c.val

12switch.c.val.o: 12switch.c
	valgrind ./comelang2-val -o 12switch.c.val.o -c 12switch.c 2> 12switch.c.val

13op.c.val.o: 13op.c
	valgrind ./comelang2-val -o 13op.c.val.o -c 13op.c 2> 13op.c.val

14struct.c.val.o: 14struct.c
	valgrind ./comelang2-val -o 14struct.c.val.o -c 14struct.c 2> 14struct.c.val

15union.c.val.o: 15union.c
	valgrind ./comelang2-val -o 15union.c.val.o -c 15union.c 2> 15union.c.val

16enum.c.val.o: 16enum.c
	valgrind ./comelang2-val -o 16enum.c.val.o -c 16enum.c 2> 16enum.c.val

17typedef.c.val.o: 17typedef.c
	valgrind ./comelang2-val -o 17typedef.c.val.o -c 17typedef.c 2> 17typedef.c.val

18field.c.val.o: 18field.c
	valgrind ./comelang2-val -o 18field.c.val.o -c 18field.c 2> 18field.c.val

19eq.c.val.o: 19eq.c
	valgrind ./comelang2-val -o 19eq.c.val.o -c 19eq.c 2> 19eq.c.val

20method.c.val.o: 20method.c
	valgrind ./comelang2-val -o 20method.c.val.o -c 20method.c 2> 20method.c.val

21obj.c.val.o: 21obj.c
	valgrind ./comelang2-val -o 21obj.c.val.o -c 21obj.c 2> 21obj.c.val

22impl.c.val.o: 22impl.c
	valgrind ./comelang2-val -o 22impl.c.val.o -c 22impl.c 2> 22impl.c.val

23interface.c.val.o: 23interface.c
	valgrind ./comelang2-val -o 23interface.c.val.o -c 23interface.c 2> 23interface.c.val

comelang2-inf: remove-inf-obj 01main.c.inf.o 02transpile.c.inf.o 03transpile2.c.inf.o 04heap.c.inf.o 05function.c.inf.o 05function2.c.inf.o 05function3.c.inf.o 05function4.c.inf.o 06str.c.inf.o 07var.c.inf.o 08if.c.inf.o 09while.c.inf.o 10do_while.c.inf.o 11for.c.inf.o 12switch.c.inf.o 13op.c.inf.o 14struct.c.inf.o 15union.c.inf.o 16enum.c.inf.o 17typedef.c.inf.o 18field.c.inf.o 19eq.c.inf.o 20method.c.inf.o 21obj.c.inf.o 22impl.c.inf.o 23interface.c.inf.o install-lib
	sudo mkdir -p "$(DESTDIR)/lib"
	sudo $(INSTALL) -m 644 ./libcomelang2.a "$(DESTDIR)/lib"
	./comelang2 -o comelang2-inf  01main.c.inf.o 02transpile.c.inf.o 03transpile2.c.inf.o 04heap.c.inf.o 05function.c.inf.o 05function2.c.inf.o 05function3.c.inf.o 05function4.c.inf.o 06str.c.inf.o 07var.c.inf.o 08if.c.inf.o 09while.c.inf.o 10do_while.c.inf.o 11for.c.inf.o 12switch.c.inf.o 13op.c.inf.o 14struct.c.inf.o 15union.c.inf.o 16enum.c.inf.o 17typedef.c.inf.o 18field.c.inf.o 19eq.c.inf.o 20method.c.inf.o 21obj.c.inf.o 22impl.c.inf.o 23interface.c.inf.o

remove-inf-obj:
	rm -f *.inf.o

01main.c.inf.o: 01main.c
	./comelang2-inf -o 01main.c.inf.o -c 01main.c

02transpile.c.inf.o: 02transpile.c
	./comelang2-inf -o 02transpile.c.inf.o -c 02transpile.c

03transpile2.c.inf.o: 03transpile2.c
	./comelang2-inf -o 03transpile2.c.inf.o -c 03transpile2.c

04heap.c.inf.o: 04heap.c
	./comelang2-inf -o 04heap.c.inf.o -c 04heap.c

05function.c.inf.o: 05function.c
	./comelang2-inf -o 05function.c.inf.o -c 05function.c

05function2.c.inf.o: 05function2.c
	./comelang2-inf -o 05function2.c.inf.o -c 05function2.c

05function3.c.inf.o: 05function3.c
	./comelang2-inf -o 05function3.c.inf.o -c 05function3.c

05function4.c.inf.o: 05function4.c
	./comelang2-inf -o 05function4.c.inf.o -c 05function4.c

06str.c.inf.o: 06str.c
	./comelang2-inf -o 06str.c.inf.o -c 06str.c

07var.c.inf.o: 07var.c
	./comelang2-inf -o 07var.c.inf.o -c 07var.c

08if.c.inf.o: 08if.c
	./comelang2-inf -o 08if.c.inf.o -c 08if.c

09while.c.inf.o: 09while.c
	./comelang2-inf -o 09while.c.inf.o -c 09while.c

10do_while.c.inf.o: 10do_while.c
	./comelang2-inf -o 10do_while.c.inf.o -c 10do_while.c

11for.c.inf.o: 11for.c
	./comelang2-inf -o 11for.c.inf.o -c 11for.c

12switch.c.inf.o: 12switch.c
	./comelang2-inf -o 12switch.c.inf.o -c 12switch.c

13op.c.inf.o: 13op.c
	./comelang2-inf -o 13op.c.inf.o -c 13op.c

14struct.c.inf.o: 14struct.c
	./comelang2-inf -o 14struct.c.inf.o -c 14struct.c

15union.c.inf.o: 15union.c
	./comelang2-inf -o 15union.c.inf.o -c 15union.c

16enum.c.inf.o: 16enum.c
	./comelang2-inf -o 16enum.c.inf.o -c 16enum.c

17typedef.c.inf.o: 17typedef.c
	./comelang2-inf -o 17typedef.c.inf.o -c 17typedef.c

18field.c.inf.o: 18field.c
	./comelang2-inf -o 18field.c.inf.o -c 18field.c

19eq.c.inf.o: 19eq.c
	./comelang2-inf -o 19eq.c.inf.o -c 19eq.c

20method.c.inf.o: 20method.c
	./comelang2-inf -o 20method.c.inf.o -c 20method.c

21obj.c.inf.o: 21obj.c
	./comelang2-inf -o 21obj.c.inf.o -c 21obj.c

22impl.c.inf.o: 22impl.c
	./comelang2-inf -o 22impl.c.inf.o -c 22impl.c

23interface.c.inf.o: 23interface.c
	./comelang2-inf -o 23interface.c.inf.o -c 23interface.c



comelang2: 01main.c.o 02transpile.c.o 03transpile2.c.o 04heap.c.o 05function.c.o 05function2.c.o 05function3.c.o 05function4.c.o 06str.c.o 07var.c.o 08if.c.o 09while.c.o 10do_while.c.o 11for.c.o 12switch.c.o 13op.c.o 14struct.c.o 15union.c.o 16enum.c.o 17typedef.c.o 18field.c.o 19eq.c.o 20method.c.o 21obj.c.o 22impl.c.o 23interface.c.o install-lib
	sudo mkdir -p "$(DESTDIR)/lib"
	sudo $(INSTALL) -m 644 ./libcomelang2.a "$(DESTDIR)/lib"
	./comelang2-sh -o comelang2  01main.c.o 02transpile.c.o 03transpile2.c.o 04heap.c.o 05function.c.o 05function2.c.o 05function3.c.o 05function4.c.o 06str.c.o 07var.c.o 08if.c.o 09while.c.o 10do_while.c.o 11for.c.o 12switch.c.o 13op.c.o 14struct.c.o 15union.c.o 16enum.c.o 17typedef.c.o 18field.c.o 19eq.c.o 20method.c.o 21obj.c.o 22impl.c.o 23interface.c.o

01main.c.o: 01main.c
	./comelang2-sh -o 01main.c.o -c 01main.c

02transpile.c.o: 02transpile.c
	./comelang2-sh -o 02transpile.c.o -c 02transpile.c

03transpile2.c.o: 03transpile2.c
	./comelang2-sh -o 03transpile2.c.o -c 03transpile2.c

04heap.c.o: 04heap.c
	./comelang2-sh -o 04heap.c.o -c 04heap.c

05function.c.o: 05function.c
	./comelang2-sh -o 05function.c.o -c 05function.c

05function2.c.o: 05function2.c
	./comelang2-sh -o 05function2.c.o -c 05function2.c

05function3.c.o: 05function3.c
	./comelang2-sh -o 05function3.c.o -c 05function3.c

05function4.c.o: 05function4.c
	./comelang2-sh -o 05function4.c.o -c 05function4.c

06str.c.o: 06str.c
	./comelang2-sh -o 06str.c.o -c 06str.c

07var.c.o: 07var.c
	./comelang2-sh -o 07var.c.o -c 07var.c

08if.c.o: 08if.c
	./comelang2-sh -o 08if.c.o -c 08if.c

09while.c.o: 09while.c
	./comelang2-sh -o 09while.c.o -c 09while.c

10do_while.c.o: 10do_while.c
	./comelang2-sh -o 10do_while.c.o -c 10do_while.c

11for.c.o: 11for.c
	./comelang2-sh -o 11for.c.o -c 11for.c

12switch.c.o: 12switch.c
	./comelang2-sh -o 12switch.c.o -c 12switch.c

13op.c.o: 13op.c
	./comelang2-sh -o 13op.c.o -c 13op.c

14struct.c.o: 14struct.c
	./comelang2-sh -o 14struct.c.o -c 14struct.c

15union.c.o: 15union.c
	./comelang2-sh -o 15union.c.o -c 15union.c

16enum.c.o: 16enum.c
	./comelang2-sh -o 16enum.c.o -c 16enum.c

17typedef.c.o: 17typedef.c
	./comelang2-sh -o 17typedef.c.o -c 17typedef.c

18field.c.o: 18field.c
	./comelang2-sh -o 18field.c.o -c 18field.c

19eq.c.o: 19eq.c
	./comelang2-sh -o 19eq.c.o -c 19eq.c

20method.c.o: 20method.c
	./comelang2-sh -o 20method.c.o -c 20method.c

21obj.c.o: 21obj.c
	./comelang2-sh -o 21obj.c.o -c 21obj.c

22impl.c.o: 22impl.c
	./comelang2-sh -o 22impl.c.o -c 22impl.c

23interface.c.o: 23interface.c
	./comelang2-sh -o 23interface.c.o -c 23interface.c

comelang2-sh: 01main.c.o.tmp 02transpile.c.o.tmp 03transpile2.c.o.tmp 04heap.c.o.tmp 05function.c.o.tmp 05function2.c.o.tmp 05function3.c.o.tmp 05function4.c.o.tmp 06str.c.o.tmp 07var.c.o.tmp 08if.c.o.tmp 09while.c.o.tmp 10do_while.c.o.tmp 11for.c.o.tmp 12switch.c.o.tmp 13op.c.o.tmp 14struct.c.o.tmp 15union.c.o.tmp 16enum.c.o.tmp 17typedef.c.o.tmp 18field.c.o.tmp 19eq.c.o.tmp 20method.c.o.tmp 21obj.c.o.tmp 22impl.c.o.tmp 23interface.c.o.tmp libcomelang2.a
	clang -o comelang2-sh  01main.c.o.tmp 02transpile.c.o.tmp 03transpile2.c.o.tmp 04heap.c.o.tmp 05function.c.o.tmp 05function2.c.o.tmp 05function3.c.o.tmp 05function4.c.o.tmp 06str.c.o.tmp 07var.c.o.tmp 08if.c.o.tmp 09while.c.o.tmp 10do_while.c.o.tmp 11for.c.o.tmp 12switch.c.o.tmp 13op.c.o.tmp 14struct.c.o.tmp 15union.c.o.tmp 16enum.c.o.tmp 17typedef.c.o.tmp 18field.c.o.tmp 19eq.c.o.tmp 20method.c.o.tmp 21obj.c.o.tmp 22impl.c.o.tmp 23interface.c.o.tmp libcomelang2.a
	cp comelang2-sh comelang2

libcomelang2.a: libcomelang2.c.c
	clang -o libcomelang2.c.o -c libcomelang2.c.c
	ar r libcomelang2.a libcomelang2.c.o

01main.c.o.tmp: 01main.c.c
	clang -o 01main.c.o.tmp -c 01main.c.c

02transpile.c.o.tmp: 02transpile.c.c
	clang -o 02transpile.c.o.tmp -c 02transpile.c.c

03transpile2.c.o.tmp: 03transpile2.c.c
	clang -o 03transpile2.c.o.tmp -c 03transpile2.c.c

04heap.c.o.tmp: 04heap.c.c
	clang -o 04heap.c.o.tmp -c 04heap.c.c

05function.c.o.tmp: 05function.c.c
	clang -o 05function.c.o.tmp -c 05function.c.c

05function2.c.o.tmp: 05function2.c.c
	clang -o 05function2.c.o.tmp -c 05function2.c.c

05function3.c.o.tmp: 05function3.c.c
	clang -o 05function3.c.o.tmp -c 05function3.c.c

05function4.c.o.tmp: 05function4.c.c
	clang -o 05function4.c.o.tmp -c 05function4.c.c

06str.c.o.tmp: 06str.c.c
	clang -o 06str.c.o.tmp -c 06str.c.c

07var.c.o.tmp: 07var.c.c
	clang -o 07var.c.o.tmp -c 07var.c.c

08if.c.o.tmp: 08if.c.c
	clang -o 08if.c.o.tmp -c 08if.c.c

09while.c.o.tmp: 09while.c.c
	clang -o 09while.c.o.tmp -c 09while.c.c

10do_while.c.o.tmp: 10do_while.c.c
	clang -o 10do_while.c.o.tmp -c 10do_while.c.c

11for.c.o.tmp: 11for.c.c
	clang -o 11for.c.o.tmp -c 11for.c.c

12switch.c.o.tmp: 12switch.c.c
	clang -o 12switch.c.o.tmp -c 12switch.c.c

13op.c.o.tmp: 13op.c.c
	clang -o 13op.c.o.tmp -c 13op.c.c

14struct.c.o.tmp: 14struct.c.c
	clang -o 14struct.c.o.tmp -c 14struct.c.c

15union.c.o.tmp: 15union.c.c
	clang -o 15union.c.o.tmp -c 15union.c.c

16enum.c.o.tmp: 16enum.c.c
	clang -o 16enum.c.o.tmp -c 16enum.c.c

17typedef.c.o.tmp: 17typedef.c.c
	clang -o 17typedef.c.o.tmp -c 17typedef.c.c

18field.c.o.tmp: 18field.c.c
	clang -o 18field.c.o.tmp -c 18field.c.c

19eq.c.o.tmp: 19eq.c.c
	clang -o 19eq.c.o.tmp -c 19eq.c.c

20method.c.o.tmp: 20method.c.c
	clang -o 20method.c.o.tmp -c 20method.c.c

21obj.c.o.tmp: 21obj.c.c
	clang -o 21obj.c.o.tmp -c 21obj.c.c

22impl.c.o.tmp: 22impl.c.c
	clang -o 22impl.c.o.tmp -c 22impl.c.c

23interface.c.o.tmp: 23interface.c.c
	clang -o 23interface.c.o.tmp -c 23interface.c.c

#########################################
# install
#########################################
install:
	sudo mkdir -p "$(DESTDIR)/bin"
	sudo $(INSTALL) -m 755 ./comelang2 "$(DESTDIR)/bin"
	sudo mkdir -p "$(DESTDIR)/include"
	sudo $(INSTALL) -m 644 ./comelang2.h "$(DESTDIR)/include"
	sudo mkdir -p "$(DESTDIR)/lib"
	sudo $(INSTALL) -m 644 ./libcomelang2.a "$(DESTDIR)/lib"
	sudo mkdir -p "$(DESTDIR)/share/doc/comelang2"
	sudo $(INSTALL) -m 644 README.md "$(DESTDIR)/share/doc/comelang2/README.md"
	cp comelang2 comelang2-inf
	cp comelang2 comelang2-val

install-lib: libcomelang2.a
	sudo mkdir -p "$(DESTDIR)/lib"
	sudo $(INSTALL) -m 644 ./libcomelang2.a "$(DESTDIR)/lib"

#########################################
# clean
#########################################
clean:
	rm -fR *.c.o comelang2 libcomelang2.a *.o a *.tmp comelang2-val comelang2-sh comelang2-inf *.i *.val

distclean: clean
	rm -fR  config.h Makefile autom4te.cache 

#########################################
# uninstall
#########################################
uninstall:
	rm -f "$(DESTDIR)"/bin/comelang2
	rm -f "$(DESTDIR)"/include/comelang2.h
	rm -f "$(DESTDIR)"/lib/libcomelang2.a
	rm -f "$(DESTDIR)/share/doc/comelang2/README.md"

